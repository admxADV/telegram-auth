# üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –û—Ç–ª–∞–¥–∫–∞

## üîç –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ —Ç–µ–ø–µ—Ä—å –≤ **JSON —Ñ–æ—Ä–º–∞—Ç–µ** —Å –ø–æ–ª—è–º–∏:
- `timestamp` ‚Äî –≤—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è
- `level` ‚Äî —É—Ä–æ–≤–µ–Ω—å (INFO, WARN, ERROR)
- `module` ‚Äî –º–æ–¥—É–ª—å (API, DB, BOT, HTTP, HEALTH)
- `request_id` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∑–∞–ø—Ä–æ—Å–∞
- `user_id` ‚Äî ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–µ—Å–ª–∏ –µ—Å—Ç—å)
- `message` ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è

### –ü—Ä–∏–º–µ—Ä –ª–æ–≥–∞:
```json
{
  "timestamp": "2026-02-21T10:30:00.000Z",
  "level": "INFO",
  "module": "API",
  "request_id": "550e8400-e29b-41d4-a716-446655440000",
  "user_id": "7273603260",
  "message": "–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è",
  "company": "PAVEPO",
  "department": "IT",
  "job_title": "Developer"
}
```

---

## üè• Health Check

**Endpoint:** `GET /health` –∏–ª–∏ `GET /api/health`

**–û—Ç–≤–µ—Ç (200 OK):**
```json
{
  "status": "healthy",
  "timestamp": "2026-02-21T10:30:00.000Z",
  "services": {
    "database": "healthy",
    "bot": "healthy"
  },
  "uptime": 3600.5
}
```

**–û—Ç–≤–µ—Ç (503 Service Unavailable):**
```json
{
  "status": "unhealthy",
  "timestamp": "2026-02-21T10:30:00.000Z",
  "error": "Database connection failed",
  "uptime": 3600.5
}
```

---

## üîó Request Tracing

–ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –ø–æ–ª—É—á–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π `request_id`, –∫–æ—Ç–æ—Ä—ã–π:
- –ü–µ—Ä–µ–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ –≤—Å–µ —Å–ª–æ–∏ —Å–∏—Å—Ç–µ–º—ã
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `X-Request-ID`
- –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ –ª–æ–≥–∏

**–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
1. –ù–∞–π–¥–∏—Ç–µ `request_id` –≤ –ª–æ–≥–∞—Ö –∫–ª–∏–µ–Ω—Ç–∞ –∏–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
2. –û—Ç—Ñ–∏–ª—å—Ç—Ä—É–π—Ç–µ –ª–æ–≥–∏ –ø–æ —ç—Ç–æ–º—É ID
3. –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–∏—Ç–µ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –∑–∞–ø—Ä–æ—Å–∞

---

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ Render

### –õ–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞:
```bash
# –í –ø–∞–Ω–µ–ª–∏ Render ‚Üí Dashboard ‚Üí Logs
# –ò–ª–∏ —á–µ—Ä–µ–∑ CLI:
render logs -s pavepo-auth
```

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —É—Ä–æ–≤–Ω—é:
```bash
# –¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏:
render logs -s pavepo-auth | grep '"level":"ERROR"'

# –¢–æ–ª—å–∫–æ API –∑–∞–ø—Ä–æ—Å—ã:
render logs -s pavepo-auth | grep '"module":"API"'
```

### Health Check URL:
```
https://pavepo-auth.onrender.com/health
```

---

## üêõ –ê–ª–≥–æ—Ä–∏—Ç–º –ü–æ–∏—Å–∫–∞ –ë–∞–≥–æ–≤

1. **–ù–∞–π—Ç–∏ –ª–æ–≥–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥ –æ—à–∏–±–∫–∏**
   ```bash
   render logs -s pavepo-auth --from "2026-02-21T10:00:00Z" --to "2026-02-21T11:00:00Z"
   ```

2. **–û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ request_id** (–µ—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–µ–Ω)
   ```bash
   render logs -s pavepo-auth | grep "550e8400-e29b-41d4-a716-446655440000"
   ```

3. **–ù–∞–π—Ç–∏ –ø–µ—Ä–≤—É—é –æ—à–∏–±–∫—É**
   ```bash
   render logs -s pavepo-auth | grep '"level":"ERROR"'
   ```

4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å health**
   ```bash
   curl https://pavepo-auth.onrender.com/health
   ```

5. **–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–æ**
   ```bash
   npm start
   ```

---

## ‚ö†Ô∏è Global Error Handling

–°–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç:
- `uncaughtException` ‚Äî –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
- `unhandledRejection` ‚Äî –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ Promise

–í—Å–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –ø–æ–ª–Ω—ã–º `stack trace`.

---

## üìÅ –§–∞–π–ª—ã –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `.qwen/AI_DEBUG_PROMPT.txt` | –ü—Ä–æ–º–ø—Ç –¥–ª—è –ò–ò —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ –æ—Ç–ª–∞–¥–∫–∏ |
| `server.js` | –°–µ—Ä–≤–µ—Ä —Å–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º |
| `render.yaml` | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Render —Å health check |
| `MONITORING.md` | –≠—Ç–æ—Ç —Ñ–∞–π–ª |

---

## üöÄ –î–µ–ø–ª–æ–π –Ω–∞ Render

–ü–æ—Å–ª–µ –ø—É—à–∞ –≤ Git:
1. Render –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–µ—Ä—ë—Ç –ø—Ä–æ–µ–∫—Ç
2. –ó–∞–ø—É—Å—Ç–∏—Ç —Å–µ—Ä–≤–µ—Ä —Å `node server.js`
3. –ù–∞—á–Ω—ë—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å `/health` endpoint

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
curl https://pavepo-auth.onrender.com/health
curl https://pavepo-auth.onrender.com/version.json
```
